function setCCTypeIcon(a){type=detectCardType(a.replace(/\s/,"")),type&&($(".ccType").removeClass("VISA").removeClass("MASTERCARD").addClass(type),$("#BuyCctype").val(type))}function seatSelection(){$container=$(".seatsSelection"),$(".status-0",$container).on("click",seatClick)}function seatClick(){if(ticketsSelected.length<=countTickets&&countTickets){$(".seatCheck",$(this)).attr("checked",!0),$(this).removeClass("status-0"),$(this).addClass("status-selected");var a=/place-\d+-\d+/.exec($(this).attr("class"))[0];ticketsSelected.push(a),ticketsSelected.length>countTickets&&($("."+ticketsSelected[0]).removeClass("status-selected"),$("."+ticketsSelected[0]).addClass("status-0"),$(".seatCheck",$("."+ticketsSelected[0])).attr("checked",!1),ticketsSelected.splice(0,1))}else 0==countTickets&&($(".message .content",$container).html("<p>"+__("no-tickets-selected-yet")+"</p><a href='#tickets' class='btn'>"+__("select-tickets")+"</a>"),$(".message",$container).show("fast"))}function setSeatsSelected(){$.each(BuySeat,function(a,b){$.each(b.grid,function(a,b){"0"!=b&&($place=$(".place-"+b),$(".seatCheck",$place).attr("checked",!0),$place.removeClass("status-0").addClass("status-selected"),$place.hasClass("status-1")&&$place.removeClass("status-1").on("click",seatClick),ticketsSelected.push("place-"+b))})})}function detectCardType(a){var b={electron:/^(4026|417500|4405|4508|4844|4913|4917)\d+$/,maestro:/^(5018|5020|5038|5612|5893|6304|6759|6761|6762|6763|0604|6390)\d+$/,dankort:/^(5019)\d+$/,interpayment:/^(636)\d+$/,unionpay:/^(62|88)\d+$/,visa:/^4[0-9]{12}(?:[0-9]{3})?$/,mastercard:/^5[1-5][0-9]{14}$/,amex:/^3[47][0-9]{13}$/,diners:/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/,discover:/^6(?:011|5[0-9]{2})[0-9]{12}$/,jcb:/^(?:2131|1800|35\d{3})\d{11}$/};return b.electron.test(a)?"ELECTRON":b.maestro.test(a)?"MAESTRO":b.dankort.test(a)?"DANKORT":b.interpayment.test(a)?"INTERPAYMENT":b.unionpay.test(a)?"UNIONPAY":b.visa.test(a)?"VISA":b.mastercard.test(a)?"MASTERCARD":b.amex.test(a)?"AMEX":b.diners.test(a)?"DINERS":b.discover.test(a)?"DISCOVER":b.jcb.test(a)?"JCB":void 0}var countTickets=totalPayment=0,countTicketsLimit=10,ticketsSelected=[];$(document).on("ready",function(){function a(){totalPayment=0,$(".ticketsSelection tr").each(function(){$parent=$(this),$cantidad=$(".cantidad",$parent),cantidad=$cantidad.data("qty"),precio=$(".price",$parent).data("price"),subtotal=precio*cantidad,$(".subtotal",$parent).html("$"+subtotal.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")),totalPayment+=subtotal,$(".ticketsSelection .total .value").html("$"+totalPayment.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"))})}$.ajax({url:"/shows/seatlayout/"+$("#SeatLayout").data("show"),success:function(a){$("#SeatLayout").html(a),seatSelection(),setSeatsSelected()}}),$(".ticketsSelection .plus").on("click",function(){$parent=$(this).closest("tr"),$cantidad=$(".cantidad",$parent),$qtyInput=$("input[rel='qty']",$parent),cantidad=$cantidad.data("qty"),precio=$(".price",$parent).data("price"),$(".message",$container).hide("fast"),countTicketsLimit>countTickets&&(cantidad++,countTickets++,$cantidad.data("qty",cantidad),$cantidad.html(cantidad),$qtyInput.attr("value",cantidad),a())}),$(".ticketsSelection .less").on("click",function(){$parent=$(this).closest("tr"),$cantidad=$(".cantidad",$parent),$qtyInput=$(".qtyInput",$parent),cantidad=$cantidad.data("qty"),precio=$(".price",$parent).data("price"),cantidad&&(cantidad--,countTickets--,$cantidad.data("qty",cantidad),$cantidad.html(cantidad),$qtyInput.attr("value",cantidad),a())}),$("input[rel='qty']").each(function(){$parent=$(this).closest("tr"),$cantidad=$(".cantidad",$parent),countTickets+=1*$(this).attr("value"),$cantidad.data("qty",$(this).attr("value")).html($(this).attr("value")),$cantidad.data("qty")}),a(),$(document).on("click",".closeMessage",function(){$(this).closest(".message").hide("fast")}),setCCTypeIcon($("#BuyCcnumber").val()),$(document).on("change","#BuyCcnumber",function(){setCCTypeIcon($(this).val())})});