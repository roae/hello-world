(function($){$.fn.Floating=function(options){var elements=[];if($("body").data("FloatingElements")){elements=$("body").data("FloatingElements")}this.each(function(){elements.push(this)});$("body").data("FloatingElements",elements);$(window).unbind("scroll.Floating",Scroll);$.each(elements,function(index,element){var tag=this.tagName.toLowerCase();var $this=$(element);if($(element).data("Floating")){hideFloating($(element))}var top=$this.offset().top-parseFloat($this.css("margin-top").replace(/auto/,0));var left=$this.offset().left;var topOffset=0;$.each(elements,function(i,element){var _top=$(element).offset().top-parseFloat($(element).css("margin-top").replace(/auto/,0));var x1=$(element).offset().left;var x2=$(element).offset().left+$(element).outerWidth();if(i!=index&&_top<top&&(left>=x1&&left<=x2)){top-=$(element).outerHeight(true);topOffset+=$(element).outerHeight(true)}});$this.data("Floating",{inlineCss:!$this.attr("style")?"":$this.attr("style"),top:top,topOffset:topOffset});data={element:$this};$(window).bind("scroll.Floating",data,Scroll)});$(window).trigger("scroll.Floating");return};function Scroll(event){if($(this).scrollTop()>=event.data.element.data("Floating").top&&!event.data.element.hasClass("fixed")){setFloating(event.data.element)}else if($(this).scrollTop()<=event.data.element.data("Floating").top&&event.data.element.hasClass("fixed")){hideFloating(event.data.element)}}function setFloating($this){topOffset=$this.data("Floating").topOffset;$this.css({width:$this.width()});if($this[0].tagName.toLowerCase()=="thead"){$this.each(function(index,node){$(node.parentNode).find("th,tbody tr:first td").each(function(key,cell){$(cell).css({width:$(cell).css("width")})})})}var randomNum=Math.ceil(Math.random()*9999);$this.data("PanelSpaceID","FloatingSpace"+randomNum);var tag=$this[0].tagName.toLowerCase();var tags=["tr"];var $childrens="&nbsp;";if(_.contains(tags,tag)){$childrens=$this.children().clone()}$this.before($("<"+tag+"/>",{id:$this.data("PanelSpaceID")}).css({width:$this.outerWidth(true)+"px",height:$this.outerHeight(true)+"px","float":$this.css("float"),display:$this.css("display")}).append($childrens));$this.addClass("fixed").css({top:topOffset+"px",position:"fixed"})}function hideFloating($this){$this.attr("style",$this.data("Floating").inlineCss);if($this[0].tagName.toLowerCase()=="thead"){$this.each(function(index,node){$(node.parentNode).find("th,tbody tr:first td").each(function(key,cell){$(cell).css({width:""})})})}$("#"+$this.data("PanelSpaceID")).remove();$this.removeClass("fixed")}function resizeElements(){}})(jQuery);$(function(){$(".floating").Floating()});